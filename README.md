# compensation-method
Программа предназначена в первую очередь для измерения амплитуды импульсных сигналов. Также имеется возможность измерения постоянного напряжения. Тип исследуемого сигнала (постоянное или импульсное напряжение) определяется автоматически. Процесс измерения запускается нажатием на кнопку "Начать". Перед началом измерений пользователь должен выбрать адреса осциллографа и калибратора из списка адресов подключенных приборов. 

Текущая программа написана для измерительного комплекса, состоящего из калибратора Fluke 9500B и осциллографа Keysight MXR(EXR). Проверка корректности подключения (т.е. что подключены именно эти типы приборов) не производится!!!

Предусмотрены три типа измерений: 
- измерение с помощью собственных параметров осциллографа;
- измерение средних на интервалах значений;
- измерение мгновенных значений на границах интервалов. 
При измерении с помощью собственных параметров осциллографа используются рассчитанные самим осциллографом средние значения напряжения (Vavg), полученные как усреднением как по времени, так и по нескольким волновым формам, если включено усреднение. При измерении средних на интервалах значений рассчитываются, собственно, средние значения на интервалах длительностью, предварительно заданной пользователем в соответствующем поле. То же для измерений мгновенных значений, только в этом случае усреднение всех значений, попавших в интервал, не производится. По умолчанию в поле, содержащем значение интервала, установлен 0, и при попытке запустить измерение средних на интервалах и мгновенных значений будет (должно быть) выброшено исключение, измерение не будет произведено.

Амплитуда импульсных сигналов измеряется в два этапа. Сначала устанавливается видимой полжительная часть импульса (вершина), задается центрирующее смещение и минимально возможный коэффициент отклонения, производятся измерения, затем отрицательная часть (основание), также устанавливаются соответствующие к.о., смещение, производятся измерения. При измерении с помощью собственных параметров осциллографа амплитуда рассчитывается и записывается в протокол, при других типах измерений - нет. Измеренное значение межканальной погрешности просто записывается в протокол, но не учитывается в расчетных значениях.

Имеется возможность задать сдвиг видимой области измерений, значение сдвига определяет длительность отбрасываемого участка волновой формы, отсчитываемую от фронта сигнала синхронизации. Это нужно для исключения влияния переходных процессов и выбросов на результат измерения. По умолчанию в соответствующем поле установлен 0, и, если пользователь не задаст ненулевое значение, будет установлен сдвиг, равный пяти длительностям фронта. Сдвиг применяется как при определении уровня вершины, так и при определении уровня основания. Возможно, потребуется применять разные значения сдвига для вершины и основания, для чего необходима доработка.

Измерение амплитуды импульсного сигнала возможно только при поданном на вход осциллографа "AUX TRIG IN" (на задней панели) сигнала синхронизации. В текущей версии программы нет возможности установить тип перепада и уровень сигнала синхронизации, при которых должен срабатывать триггер осциллографа. В тексте программы прописаны команды для срабатывания триггера по положительному перепаду внешнего сигнала синхронизации (AUX) на уровне 1 В. Тестирование программы с генератором AFG3101 в качестве источника показало, что такая возможность скорее всего потребуется, особенно при измерении амплитуды импульсных сигналов с малым периодом повторения. 

В тексте исходников там, где я счел нужным, даны комментарии.

Также имеется .xlsm файл с оригинальной версией программы на VBA, которая немного отличается. На всякий случай.

SCPI команды и их описание для осциллографа Keysight MXR(EXR) можно посмотреть в файле "EXR programmers guide.chm". "NI-VISAProgrammersMan.pdf" - про интерфейс VISA и его использование в С/С++.
